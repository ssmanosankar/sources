<!DOCTYPE html>
<html lang="en">
<head>
  <title>Dashboard</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
  <script src="jquery.tabledit.min.js"></script>
 

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css" /></script>
  <style>
    /* Set height of the grid so .sidenav can be 100% (adjust if needed) */
    .row.content {height: 1250px}
    
    /* Set gray background color and 100% height */
    .sidenav {
      background-color: #f1f1f1;
      height: 100%;
    }
    
    /* Set black background color, white text and some padding */
    
    /* On small screens, set height to 'auto' for sidenav and grid */
    @media screen and (width: 400px) {
      .sidenav {
        height: auto;
        padding: 15px;
      }
      .row.content {height: auto;} 

      .l
      {
        margin-left: 40px;
      }
     
      
    }
  </style>
</head>

<body>

<div class="container-fluid">
  <div class="row content">
    <div class="col-sm-2 sidenav">
      <img src="aname.png" height="60" width="160" alt="Logo">

      <ul class="nav nav-pills nav-stacked">
        <li id="t1" class="active"><a><div><img src="member.png" width="20"height="20">Members</div></a></li>
        <li id="t2"><a><div><img src="i1.png" width="20"height="20">Attendance</div></a></li>
        <li id="t3"><a><div><img src="clipboard.png" width="20"height="20">Tasks</div></a></li>
      </ul><br>
      
    </div>

                  <!-- Third Division -->
                  <div id="tt3">
                             
                      <h4>Hello</h4>
                  </div>
        

    <!-- Second Division -->
    <div id="tt2">
      <center>        <div class="btn-group" role="group" aria-label="Buttons">
            <button type="button" class="btn btn-dark" onclick="hide()"id="at">Attendance</button>
            <button type="button" class="btn btn-dark"  onclick="hide1()" id="att">Attendance Details</button>      
         </div>
        </center>
    <div class="table-responsive">  
                
                <!-- Filter Icon Process -->
                
                <div class="modal" id="filter">
                  <div class="modal-dialog">
                    <div class="modal-content">
                    
                      <!-- Modal Header -->
                      <div class="modal-header">
                        <h4 class="modal-title">Date Sort</h4>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                      </div>
                      
                      <!-- Modal body -->
                      <div class="modal-body">

                        <form id="sort" method="POST" action="datesort.php">
                          <label>From Date:</label><input type="date" class="form-control" id="from" value="" name="date1" placeholder="From date" >
                          <label>To Date:</label> <input type="date" class="form-control" id="to" value="" name="date2" placeholder="To date" >             
                          <br><center> <input type="submit" class="btn btn-primary" value="Search" data-toggle="modal" data-target="#date"></center>
                        </form>             
                      </div>
                      
                      <!-- Modal footer -->
                      <div class="modal-footer">
                        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                      </div>
                      
                    </div>
                  </div>
                </div>


                <div class="modal" id="date">
                  <div class="modal-dialog">
                    <div class="modal-content">
                    
                      <!-- Modal Header -->
                      <div class="modal-header">
                        <h4 class="modal-title">Attendance List</h4>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                      </div>
                      
                      <!-- Modal body -->
                      <div class="modal-body">
                          <table class="table table-striped" id="date_table" >
                            <thead>
                            <tr>
                              <th>Name</th>
                              <th>Date</th>
                              <th>Status</th>
                              <th>Reason</th>
                            </tr>
                          </thead>
                          
                        </table>
                       
                      </div>
                      
                      <!-- Modal footer -->
                      <div class="modal-footer">
                        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                      </div>
                      
                    </div>
                  </div>
                </div>



                <!-- Attendance Form -->
                <div id="tt4">
                    <h3>Attendance Details</h3>
                  <form id="statusform" method="POST" action="attendance.php">
                              <table class="table table-striped" id="attendance_table" >
                                <thead style="background-color:#1fd3af">
                                  <tr>
                                    <th>Name</th>
                                    <th>Date</th>
                                    <th>Status</th>
                                    <th>Reason</th>
                                  </tr>
                              </thead>                                
                                </table>
                                <!-- onclick="hide()" -->
                               <center><input type="submit" name="submit" class="btn btn-primary"  value="Update" ></center> 
                            </form>
                            
                          </div>

                            <div id="tt5">  
                            <h3>Attendance Details of the Members</h3>        
                            <div> 
                              <input type="image" src="filter.png" alt="click" width="35" height="35" id="im" data-toggle="modal" data-target="#filter">
                            </div>   
                                    
                            <table class="table table-striped" id="attendance_details_table" >
                                      <thead style="background-color:#1fd3af">
                                        <tr>
                                          <th>Name</th>
                                          <th>Date</th>
                                          <th>Status</th>
                                          <th>Reason</th>
                                        </tr>
                                      </thead>
                                      
                                    </table>
                            
                                 </div>
                                



 

                              <div class="modal" id="attendance">
                                  <div class="modal-dialog">
                                    <div class="modal-content">
                                    
                                      <!-- Modal Header -->
                                      <div class="modal-header">
                                        <h4 class="modal-title">Attendance</h4>
                                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                                      </div>
                                      
                                      <!-- Modal body -->
                                      <div class="modal-body">

                                        <form id="attendance_form" method="POST" action="attendance.php">
                                          <table class="table table-bordered table-striped" id="attend_table" >
                                          <label>Members Attendance</label>
                                            <thead>
                                            <tr>
                                              <th>Name</th>
                                              <th>Attendance</th>
                                            </tr>
                                          </thead>
                                          
                                        </table>
                                        <center>
                                        <input type="submit" class="btn btn-primary" value="Submit" name="attendsubmit">
                                         </center> 
                                       </form>
                                      </div>
                                      
                                      <!-- Modal footer -->
                                      <div class="modal-footer">
                                        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                                      </div>
                                      
                                    </div>
                                  </div>
                                </div>
      </div>
      </div>
     

    <!-- First Division Start -->
    <div id="tt1"  >
    <div class="table-responsive">  
      <h3>Members Details</h3>        
                    <table class="table table-striped" id="members_table" >
                      <thead style="background-color:#1fd3af">
                        <tr>
                          <th>Id</th>
                          <th>Name</th>
                          <th>Age</th>
                          <th>Phone</th>
                          <th>Address</th>
                          <th>Gender</th>
                          <th>Experience</th>
                        </tr>
                      </thead>
                      
                    </table>
                    
<!-- This is For Add Modal -->
         <!-- The Modal -->
  <div class="modal" id="myModal1">
    <div class="modal-dialog">
      <div class="modal-content">
    
        <!-- Modal Header -->
        <div class="modal-header">
          <h4 class="modal-title">Add Your Information Here!!!!</h4>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
    
        <!-- Modal body -->
        <div class="modal-body">
          <center>
            <form id="add1"  class="form-horizontal" action="add.php" method="POST">
                
                <input type="text" placeholder="Id" class="form-control" value="" name="id" required><br>
                
                <input type="text" placeholder="Name" class="form-control" value="" name="name"  pattern=".{6,}" required title="6 characters minimum" required><br>
                <input type="text" placeholder="Age" class="form-control" value="" name="age" required><br>
              
                <input type="text" placeholder="Phone" class="form-control" value="" name="phone"  pattern="[6-9]{1}[0-9]{9}" required title="phone number start with 6-9" required><br>
              
                <input type="text" placeholder="Address" class="form-control" value="" name="address" pattern=".{25,}" required title="25 characters minimum" required><br>
                              <input type="text" placeholder="Gender" class="form-control" value="" name="gender" required>
                <br>
              
                <input type="text" class="form-control" placeholder="Experience" value="" name="experience" required>
                <br>    
      <input type="submit" class="btn btn-primary" value="Add" name="Add">
              </form>
              </center>
        </div>
        
        <!-- Modal footer -->
        <div class="modal-footer">
          <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
        </div>
        
      </div>
    </div>
  </div>
              <input type="image" src="plus.png" alt="click" width="50" height="50" id="im"  data-toggle="modal" data-target="#myModal1">
      
                    </div>
                  </div>
      <br>       
    </div>             
</div>


<!-- This is for Edit Modal -->
<div class="modal" id="myModal">
    <div class="modal-dialog">
      <div class="modal-content">
      
        <!-- Modal Header -->
        <div class="modal-header">
          <h4 class="modal-title">Edit</h4>
          <button type="button" class="close" data-dismiss="modal">&times;</button>
        </div>
        <div class="modal-body">
     <center>
          <form id="edit1" class="form-horizontal" action="edit.php" method="POST">
             
              <input id="id_edit" placeholder="Id" class="form-control" type="text" value="" name="id" required><br>
            
              
              <input id="name_edit" placeholder="Name" class="form-control" type="text" value="" name="name"  pattern=".{6,}" required title="6 characters minimum" required><br>
              
              <input  id="age_edit" placeholder="Age" class="form-control" type="text" value="" name="age"  required><br>
              
              <input id="phone_edit" placeholder="Phone" class="form-control" type="text" value="" name="phone" pattern="[6-9]{1}[0-9]{9}" required title="phone number start with 6-9" required><br>
              
              <input  id="address_edit" placeholder="Address"  class="form-control" type="text" value="" name="address" pattern=".{25,}" required title="25 characters minimum" required><br>
               <input id="gender_edit" placeholder="Gender" class="form-control" type="text" value="" name="gender" required>
              <br>
              
              <input id="experience_edit" placeholder="Experience" class="form-control" type="text" value="" name="experience" required>
              <br>    
              <input type="submit" class="btn btn-primary" value="update" name="update">
            </form>
            </center>

            <div class="modal-footer">
              <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
            </div>
        </div>        
</body>
</html>




<script>

var curr_active = $('#t1');
function hide()
{
  var cur_active=$('#tt5');
      if(cur_active.prop("id")=="tt5")
 {
  $('#tt4').show();
  $('#tt5').hide();
  
  }
}
function hide1()
{
  var cur_active=$('#tt4');
      if(cur_active.prop("id")=="tt4")
 {
  $('#tt4').hide();
  $('#tt5').show();
  
  }
}

$(document).ready(function(){


 
  $("#tt2").hide();
  $("#tt3").hide();
 

   console.log("populating");
  $('#add1').on('submit',function(e){
    e.preventDefault();
    $.ajax({
        type : 'post',
        url : 'add.php',
        data : new FormData(this),
        contentType : false,
        cache : false,
        processData : false,
        dataType : 'text',
        success : function(result){
            if(result == "success")
           alert("Added succesfully");
            else
            window.location.href = "dashboard.html";
        }

      });
    });
   
  


   $('li').click(function(e){
      $(this).addClass('active');
      curr_active.removeClass('active');
      curr_active = $(this);
      console.log($(this).prop("id"));
      if( curr_active.prop("id") == "t1" )
      {
        $("#tt1").show();
        $("#tt2").hide();
        $("#tt3").hide(); 
        $("#tt4").hide();
        $("#tt5").hide();
      }
      if( curr_active.prop("id") == "t2" )
      {
        $("#tt1").hide();
        $("#tt2").show();
        $("#tt3").hide();
        $("#tt4").show();
        $("#tt5").hide();
        $.ajax({
        url : 'check_date.php',
        success : function(result){
            if(result == 0)
            {$('#at').prop("enabled",true);
            $('#tt4').show();
        }else
            {$('#at').prop("disabled",true); 
            $('#tt4').hide(); 
            $('#tt5').show();   
        }
        
        }     
      });

      }
      if( curr_active.prop("id") == "t3" )
      {
        $("#tt1").hide();
        $("#tt2").hide();
        $("#tt3").show();
        $("#tt4").hide();
        $("#tt5").hide();
      
      }
    });
   
    $('#myList').on('change',function(){
  console.log($(this).attr("name"));
});


}); 

    populate1();
    populate3();
    populate2();
    populate();
    populate4();
     
    


$('#edit1').on('submit',function(e){
    e.preventDefault();
    $.ajax({
        type : 'post',
        url : 'edit.php',
        data : new FormData(this),
        contentType : false,
        cache : false,
        processData : false,
        dataType : 'text',
        success : function(result){
            if(result == "success")
           alert("Added succesfully");
            else
            window.location.href = "dashboard.html";
        }

      });
    });

$('#statusform').on('submit',function(e)
{
  e.preventDefault();
    $.ajax({
    type:'post',
    url:'attendance.php',
    data:new FormData(this),
    contentType:false,
    cache:false,
    processData:false,
    dataType:'text',
    success:function(result){
      if(result=="success")
      alert("Wrong")
      else
      $('#at').prop("disabled",true);
      alert("Done");
      $('#tt4').hide();
      $('#tt5').show();
      
    }
  });
  
});

function edit(id){
    $.ajax({
      type : 'post',
      url : 'edit_1.php',
      data : {id : id},
      dataType : 'json',
      success : function(result){
        console.log("value from php : ");
        console.log(result);
        $('#id_edit').val(result['id']);
        $('#name_edit').val(result['name']);
        $('#age_edit').val(result['age']);
        $('#phone_edit').val(result['phone']);
        $('#address_edit').val(result['address']);
        $('#gender_edit').val(result['gender']);
        $('#experience_edit').val(result['experience']);
             }
    });
  }


function remove_data(id){
  var result = confirm("want to delete it?");
  if(result)
  {
    $.ajax({
      type : 'post',
      url : 'remove.php',
      data : {id : id},
      dataType : 'text',
      success : function(result){
        console.log("value from php : "+result);
        $('#members_table tbody').remove();
        populate();
      }
    });
  }
  }

  function populate(){
$.getJSON("members.php",function(data){
var members_data = '<tbody>';
$.each(data,function(key,value){
    members_data += '<tr>';
    members_data += '<td>'+value.id+'</td>';
    members_data += '<td>'+value.name+'</td>';
    members_data += '<td>'+value.age+'</td>';
    members_data += '<td>'+value.phone+'</td>';
    members_data += '<td>'+value.address+'</td>';
    members_data += '<td>'+value.gender+'</td>';
    members_data += '<td>'+value.experience+'</td>';
    members_data += '<td>'+'<input type="image" src="edit.png" alt="click" width="20" height="20" id="edit"  onclick="edit('+value.id+')" id="'+value.id+'" data-toggle="modal" data-target="#myModal">'+'</td>';
    members_data += '<td>'+'<input type="image" src="delete.png" alt="click" width="20" height="20" id="delete"  onclick="remove_data('+value.id+')" id="'+value.id+'">'+'</td>';
   
    members_data += '<tr>';

});
members_data += "</tbody>";
$('#members_table').append(members_data);
});
}

//date picker
var today = new Date().toJSON().split('T')[0];
console.log(today);
$('#datePicker').val(today);
$('#datePicker').prop('max', today);
//--date pickers

   


function populate1(){
$.getJSON("attend.php",function(data){
   i=1; 
  console.log(data);
var attend_data = '<tbody>';
$.each(data,function(key,value){
    attend_data += '<tr>';
    attend_data += '<td>'+'<input type="text" class="form-control"  id="name" value='+value.name+' name="name['+i+']"></td>';
    attend_data += '<td>'+'<input type="date" class="form-control" value="" id="datePicker" name="date['+i+']">'+'</td>';
    attend_data += '<td>'+'<select class="form-control" name="status['+i+']" id = "myList">'+
               '<option value = "present">Present</option>'+
               '<option value = "abcent">Abcent</option>'+
             '</select>'
     +'</td>';
    attend_data += '<td>'+'<input type="text" class="form-control"  name="reason['+i+']"  id="reason" value="">'+'</td>';
    attend_data += '<tr>';
   i++; 

});
attend_data += "</tbody>";

$('#attendance_table').append(attend_data);
console.log(attend_data);
});
}



function populate2(){

  $('#sort').on('submit',function(e){
    e.preventDefault();
    $('#attendance_table tbody').remove();
    $.ajax({
        type : 'post',
        url : 'datesort.php',
        data : new FormData(this),
        contentType : false,
        cache : false,
        processData : false,
        dataType : 'json',
        success : function(result){
           console.log("Vlaue from php:");
           console.log(result);
           var attend_data = '<tbody>';
     $.each(result,function(key,value){
    attend_data += '<tr>';
    attend_data += '<td>'+value.name+'</td>';
    attend_data += '<td>'+value.date+'</td>';
    attend_data += '<td>'+value.status+'</td>';
    attend_data += '<td>'+value.reason+'</td>';
    attend_data += '<tr>';

});
attend_data += "</tbody>";
$('#date_table tbody').remove();
     populate2();
$('#date_table').append(attend_data);
        }

      });
    });
}



function populate3(){
$.getJSON("attendmembers.php",function(data){
  var i=1;
var a_data = '<tbody>';
$.each(data,function(key,value){
    a_data += '<tr>';
    a_data += '<td>'+'<input type="text" class="form-control" id="name_'+i+'" value="'+value.name+'" name="name" disabled>'+'</td>';
    a_data += '<td>'+
        '<input list="list" name="list_'+i+'" class="form-control" id="id">'+
        '<datalist id="id">'+
    '<option value="present">Present</option>'+
    '<option value="abcent">Abcent</option>'+
    ' </datalist>'
      +'</td>';
    a_data += '<tr>';
i++;
});
a_data += "</tbody>";
//$('#attend_table tbody').remove();
  //      populate3();
$('#attend_table').append(a_data);
});
}
function populate4(){
$.getJSON("attendance_detailshow.php",function(data){
var members_data = '<tbody>';
$.each(data,function(key,value){
    members_data += '<tr>';
    members_data += '<td>'+value.name+'</td>';
    members_data += '<td>'+value.date+'</td>';
    members_data += '<td>'+value.status+'</td>';
    members_data += '<td>'+value.reason+'</td>';
    members_data += '<tr>';

});
members_data += "</tbody>";
$('#attendance_details_table tbody').remove();
$('#attendance_details_table').append(members_data);
populate4();
});
}

setInterval(function(){
 
       populate4(); }, 100000);
   
</script>
